<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL 连接查询 | site</title>
    <meta name="description" content="summerycicada">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.b13f3be4.css" as="style"><link rel="preload" href="/blog/assets/js/app.e2cc563c.js" as="script"><link rel="preload" href="/blog/assets/js/2.7449a846.js" as="script"><link rel="preload" href="/blog/assets/js/34.55bb6b06.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.23a54832.js"><link rel="prefetch" href="/blog/assets/js/11.37fdd76f.js"><link rel="prefetch" href="/blog/assets/js/12.ffc103f7.js"><link rel="prefetch" href="/blog/assets/js/13.821f5a06.js"><link rel="prefetch" href="/blog/assets/js/14.c9068ed9.js"><link rel="prefetch" href="/blog/assets/js/15.5e2d9335.js"><link rel="prefetch" href="/blog/assets/js/16.a771186b.js"><link rel="prefetch" href="/blog/assets/js/17.f20ca4f8.js"><link rel="prefetch" href="/blog/assets/js/18.590f6d55.js"><link rel="prefetch" href="/blog/assets/js/19.b1ee7613.js"><link rel="prefetch" href="/blog/assets/js/20.4bec25a8.js"><link rel="prefetch" href="/blog/assets/js/21.5d6e2a43.js"><link rel="prefetch" href="/blog/assets/js/22.a59ae590.js"><link rel="prefetch" href="/blog/assets/js/23.ba5e61db.js"><link rel="prefetch" href="/blog/assets/js/24.eae83079.js"><link rel="prefetch" href="/blog/assets/js/25.118e1218.js"><link rel="prefetch" href="/blog/assets/js/26.c44f0c29.js"><link rel="prefetch" href="/blog/assets/js/27.ea1b3ffc.js"><link rel="prefetch" href="/blog/assets/js/28.aad56a94.js"><link rel="prefetch" href="/blog/assets/js/29.e07f7d6b.js"><link rel="prefetch" href="/blog/assets/js/3.9b7c7f29.js"><link rel="prefetch" href="/blog/assets/js/30.30e08758.js"><link rel="prefetch" href="/blog/assets/js/31.12c7cb4a.js"><link rel="prefetch" href="/blog/assets/js/32.47492022.js"><link rel="prefetch" href="/blog/assets/js/33.6d8e2518.js"><link rel="prefetch" href="/blog/assets/js/35.6dba9cfc.js"><link rel="prefetch" href="/blog/assets/js/36.dabcb9c7.js"><link rel="prefetch" href="/blog/assets/js/37.b318a0b3.js"><link rel="prefetch" href="/blog/assets/js/38.91047636.js"><link rel="prefetch" href="/blog/assets/js/39.be289b67.js"><link rel="prefetch" href="/blog/assets/js/4.be8f3dc9.js"><link rel="prefetch" href="/blog/assets/js/40.bb5421ba.js"><link rel="prefetch" href="/blog/assets/js/41.fe093910.js"><link rel="prefetch" href="/blog/assets/js/42.f5d06c5f.js"><link rel="prefetch" href="/blog/assets/js/43.b9e1e1b7.js"><link rel="prefetch" href="/blog/assets/js/44.c4d535c8.js"><link rel="prefetch" href="/blog/assets/js/45.46bd70b7.js"><link rel="prefetch" href="/blog/assets/js/46.48c687ba.js"><link rel="prefetch" href="/blog/assets/js/47.bd572ef0.js"><link rel="prefetch" href="/blog/assets/js/48.a840a7fe.js"><link rel="prefetch" href="/blog/assets/js/5.37a65126.js"><link rel="prefetch" href="/blog/assets/js/6.c9522a94.js"><link rel="prefetch" href="/blog/assets/js/7.475fc037.js"><link rel="prefetch" href="/blog/assets/js/8.7ebeef9e.js"><link rel="prefetch" href="/blog/assets/js/9.4e2e0db9.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b13f3be4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">site</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">FrontEnd</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/fe/" class="nav-link">frontend-road</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/typescript.html" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/react.html" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/util.html" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/compile.html" class="nav-link">编译</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/interview.html" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/snippet.html" class="nav-link">兼容性</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/component.html" class="nav-link">组件化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/engineering.html" class="nav-link">工程化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/module.html" class="nav-link">模块化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/performance.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Node.js</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/nodejs/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/blog/nodejs/eventloop.html" class="nav-link">EventLoop</a></li><li class="dropdown-item"><!----> <a href="/blog/nodejs/cli.html" class="nav-link">CLI</a></li></ul></div></div><div class="nav-item"><a href="/blog/java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/blog/php/" class="nav-link">PHP</a></div><div class="nav-item"><a href="/blog/python/" class="nav-link">Python</a></div><div class="nav-item"><a href="/blog/http/" class="nav-link">HTTP</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ALG</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/alg/" class="nav-link">算法与数据结构</a></li><li class="dropdown-item"><!----> <a href="/blog/alg/complexity-1.html" class="nav-link">复杂度分析（上）</a></li><li class="dropdown-item"><!----> <a href="/blog/alg/complexity-2.html" class="nav-link">复杂度分析（下）</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/" class="nav-link router-link-active">基础</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/function.html" class="nav-link">函数</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/subquery.html" class="nav-link">子查询</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/join.html" class="nav-link router-link-exact-active router-link-active">连接查询</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/sql.html" class="nav-link">SQL必知必会</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/blog/other/linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/other/shell.html" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/blog/other/centos.html" class="nav-link">CentOS</a></li></ul></div></div><div class="nav-item"><a href="/blog/movie.html" class="nav-link">movie</a></div><div class="nav-item"><a href="https://github.com/stupidsongshu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">FrontEnd</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/fe/" class="nav-link">frontend-road</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/typescript.html" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/react.html" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/util.html" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/compile.html" class="nav-link">编译</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/interview.html" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/snippet.html" class="nav-link">兼容性</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/component.html" class="nav-link">组件化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/engineering.html" class="nav-link">工程化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/module.html" class="nav-link">模块化</a></li><li class="dropdown-item"><!----> <a href="/blog/fe/performance.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Node.js</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/nodejs/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/blog/nodejs/eventloop.html" class="nav-link">EventLoop</a></li><li class="dropdown-item"><!----> <a href="/blog/nodejs/cli.html" class="nav-link">CLI</a></li></ul></div></div><div class="nav-item"><a href="/blog/java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/blog/php/" class="nav-link">PHP</a></div><div class="nav-item"><a href="/blog/python/" class="nav-link">Python</a></div><div class="nav-item"><a href="/blog/http/" class="nav-link">HTTP</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ALG</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/alg/" class="nav-link">算法与数据结构</a></li><li class="dropdown-item"><!----> <a href="/blog/alg/complexity-1.html" class="nav-link">复杂度分析（上）</a></li><li class="dropdown-item"><!----> <a href="/blog/alg/complexity-2.html" class="nav-link">复杂度分析（下）</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/" class="nav-link router-link-active">基础</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/function.html" class="nav-link">函数</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/subquery.html" class="nav-link">子查询</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/join.html" class="nav-link router-link-exact-active router-link-active">连接查询</a></li><li class="dropdown-item"><!----> <a href="/blog/mysql/sql.html" class="nav-link">SQL必知必会</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/blog/other/linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/other/shell.html" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/blog/other/centos.html" class="nav-link">CentOS</a></li></ul></div></div><div class="nav-item"><a href="/blog/movie.html" class="nav-link">movie</a></div><div class="nav-item"><a href="https://github.com/stupidsongshu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/mysql/" class="sidebar-link">MySQL</a></li><li><a href="/blog/mysql/function.html" class="sidebar-link">函数</a></li><li><a href="/blog/mysql/subquery.html" class="sidebar-link">子查询</a></li><li><a href="/blog/mysql/join.html" class="active sidebar-link">SQL 连接查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mysql/join.html#sql-标准" class="sidebar-link">SQL 标准</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/join.html#sql92" class="sidebar-link">SQL92</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/join.html#sql99" class="sidebar-link">SQL99</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/join.html#不同-dbms-中使用连接需要注意的地方" class="sidebar-link">不同 DBMS 中使用连接需要注意的地方</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/join.html#join" class="sidebar-link">Join</a></li></ul></li><li><a href="/blog/mysql/sql.html" class="sidebar-link">SQL 必知必会</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sql-连接查询"><a href="#sql-连接查询" aria-hidden="true" class="header-anchor">#</a> SQL 连接查询</h1> <div class="tip custom-block"><h2 id="sql-标准"><a href="#sql-标准" aria-hidden="true" class="header-anchor">#</a> SQL 标准</h2> <p>目前存在 SQL-86、SQL-89、SQL92、SQL99、SQL:2003、SQL:2008、SQL:2011 和 SQL:2016 等其他的标准。最重要的 SQL 标准是 SQL92 和 SQL99。</p> <ul><li>一般来说 SQL92 的形式更简单，但是写的 SQL 语句会比较长，可读性较差。</li> <li>SQL99 相比于 SQL92 来说，语法更加复杂，但可读性更强。</li></ul></div> <h2 id="sql92"><a href="#sql92" aria-hidden="true" class="header-anchor">#</a> SQL92</h2> <p>SQL92 中有 5 种连接方式，分别是笛卡尔积、等值连接、非等值连接、自连接、外连接（左连接、右连接）。</p> <h3 id="笛卡尔积"><a href="#笛卡尔积" aria-hidden="true" class="header-anchor">#</a> 笛卡尔积</h3> <p>笛卡尔乘积是一个数学运算。假设有两个集合 X 和 Y，那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。</p> <p>笛卡尔积也称为<strong>交叉连接</strong>，英文是 <code>CROSS JOIN</code>，它的作用就是可以把任意表进行连接，即使这两张表不相关。但我们通常进行连接还是需要筛选的，因此需要在连接后面加上 WHERE 子句，也就是作为过滤条件对连接数据进行筛选。比如后面的等值连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player<span class="token punctuation">,</span> team
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="等值连接"><a href="#等值连接" aria-hidden="true" class="header-anchor">#</a> 等值连接</h3> <p>两张表的等值连接就是用两张表中都存在的列进行连接，结果为这两张表的交集部分。也可以对多张表进行等值连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 针对 player 表和 team 表都存在 team_id 这一列，我们可以用等值连接进行查询</span>
<span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> player<span class="token punctuation">.</span>team_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height<span class="token punctuation">,</span> team_name
<span class="token keyword">FROM</span> player<span class="token punctuation">,</span> team
<span class="token keyword">WHERE</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="非等值连接"><a href="#非等值连接" aria-hidden="true" class="header-anchor">#</a> 非等值连接</h3> <p>进行多表查询的时候，如果连接多个表的条件是等号时，就是等值连接，其他的运算符连接就是非等值查询。</p> <h3 id="自连接"><a href="#自连接" aria-hidden="true" class="header-anchor">#</a> 自连接</h3> <p>自连接可以对多个表进行操作，也可以对同一个表进行操作。也就是说查询条件使用了当前表的字段。</p> <h3 id="外连接"><a href="#外连接" aria-hidden="true" class="header-anchor">#</a> 外连接</h3> <p>除了查询满足条件的记录以外，外连接还可以查询某一方不满足条件的记录。两张表的外连接，会有一张是主表，另一张是从表。如果是多张表的外连接，那么第一张表是主表，即显示全部的行，而剩下的表则显示对应连接的信息。在 SQL92 中采用 <code>(+)</code> 代表从表所在的位置，而且在 SQL92 中，只有左外连接和右外连接，没有全外连接。</p> <ul><li>左外连接，指的是左边的表是主表，需要显示左边表的全部行，而右侧的表是从表。</li> <li>右外连接，指的是右边的表是主表，需要显示右边表的全部行，而左侧的表是从表。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- SQL92</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player<span class="token punctuation">,</span> team <span class="token keyword">where</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
<span class="token comment">-- SQL99</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> team <span class="token keyword">on</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- SQL92</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player<span class="token punctuation">,</span> team <span class="token keyword">where</span> player<span class="token punctuation">.</span>team_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
<span class="token comment">-- SQL99</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> team <span class="token keyword">on</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="sql99"><a href="#sql99" aria-hidden="true" class="header-anchor">#</a> SQL99</h2> <h3 id="交叉连接"><a href="#交叉连接" aria-hidden="true" class="header-anchor">#</a> 交叉连接</h3> <p>交叉连接 <code>CROSS JOIN</code> 实际上就是 SQL92 中的笛卡尔乘积。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> team

<span class="token comment">-- 如果多张表进行交叉连接，比如表 t1，表 t2，表 t3 进行交叉连接</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t1 <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> t2 <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> t3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="自然连接"><a href="#自然连接" aria-hidden="true" class="header-anchor">#</a> 自然连接</h3> <p>自然连接 <code>NATURAL JOIN</code> 会自动查询两张连接表中所有相同的字段，然后进行等值连接。可以理解为 SQL92 中的等值连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- SQL92</span>
<span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> a<span class="token punctuation">.</span>team_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height<span class="token punctuation">,</span> team_name
<span class="token keyword">FROM</span> player <span class="token keyword">as</span> a<span class="token punctuation">,</span> team <span class="token keyword">as</span> b
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>team_id <span class="token operator">=</span> b<span class="token punctuation">.</span>team_id
<span class="token comment">-- SQL99 NATURAL JOIN</span>
<span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> team_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height<span class="token punctuation">,</span> team_name
<span class="token keyword">FROM</span> player
<span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> team
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="on-连接"><a href="#on-连接" aria-hidden="true" class="header-anchor">#</a> ON 连接</h3> <p><code>ON</code> 连接用来指定我们想要的连接条件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> player<span class="token punctuation">.</span>team_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height<span class="token punctuation">,</span> team_name
<span class="token keyword">FROM</span> player
<span class="token keyword">JOIN</span> team
<span class="token keyword">ON</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="using-连接"><a href="#using-连接" aria-hidden="true" class="header-anchor">#</a> USING 连接</h3> <p>当我们进行连接的时候，可以用 USING 指定数据表里的同名字段进行等值连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> team_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height<span class="token punctuation">,</span> team_name
<span class="token keyword">FROM</span> player
<span class="token keyword">JOIN</span> team
<span class="token keyword">USING</span><span class="token punctuation">(</span>team_id<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="自连接-2"><a href="#自连接-2" aria-hidden="true" class="header-anchor">#</a> 自连接</h3> <p>自连接的原理在 SQL92 和 SQL99 中都是一样的，只是表述方式不同。</p> <h3 id="外连接-2"><a href="#外连接-2" aria-hidden="true" class="header-anchor">#</a> 外连接</h3> <ul><li>左外连接：<code>LEFT JOIN</code> 或 <code>LEFT OUTER JOIN</code></li> <li>右外连接：<code>RIGHT JOIN</code> 或 <code>RIGHT OUTER JOIN</code></li> <li>全外连接：<code>FULL JOIN</code> 或 <code>FULL OUTER JOIN</code></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 全外连接</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> team <span class="token keyword">ON</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>全外连接实际上是左外连接和右外连接的结合，全外连接会返回左表和右表中的所有行。当表之间有匹配的行，会显示内连接的结果。当某行在另一个表中没有匹配时，那么会把另一个表中选择的列显示为空值。
也就是说，全外连接的结果 = 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。</p> <div class="tip custom-block"><p>SQL92 和 SQL99 标准下的连接查询操作的方式略有不同，连接操作基本上可以分成三种情况：</p> <ul><li><strong>内连接</strong>：将多个表之间满足连接条件的数据行查询出来。它包括了<strong>等值连接</strong>、<strong>非等值连接</strong>和<strong>自连接</strong>。</li> <li><strong>外连接</strong>：会返回一个表中的所有记录，以及另一个表中匹配的行。它包括了<strong>左外连接</strong>、<strong>右外连接</strong>和<strong>全外连接</strong>。</li> <li><strong>交叉连接</strong>：也称为<strong>笛卡尔积</strong>，返回左表中每一行与右表中每一行的组合。在 SQL99 中使用的是 <code>CROSS JOIN</code>。</li></ul> <p>在这三种连接操作中，SQL92 和 SQL99 存在着明显的区别：</p> <ol><li>SQL92 中的 WHERE 和 SQL99 中的 JOIN：</li></ol> <p>在 SQL92 中进行查询时，会把所有需要连接的表都放到 FROM 之后，然后在 WHERE 中写明连接的条件。</p> <p>而 SQL99 在这方面更灵活，它不需要一次性把所有需要连接的表都放到 FROM 之后，而是采用 JOIN 的方式每次连接一张表，可以多次使用 JOIN 进行连接。</p> <ol start="2"><li>建议多表连接使用 SQL99 标准，因为层次性和可读性更强。</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table1
  <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span> table1 和 table2 的连接条件
    <span class="token keyword">JOIN</span> table3 <span class="token keyword">ON</span> table2 和 table3 的连接条件

<span class="token comment">-- 嵌套逻辑类似 for 循环</span>
<span class="token keyword">for</span> t1 <span class="token operator">in</span> table1:
  <span class="token keyword">for</span> t2 <span class="token operator">in</span> table2:
    <span class="token keyword">if</span> condition1:
      <span class="token keyword">for</span> t3 <span class="token operator">in</span> table3:
        <span class="token keyword">if</span> condition2:
          output t1 <span class="token operator">+</span> t2 <span class="token operator">+</span> t3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>SQL99 采用的这种嵌套结构非常清爽，即使再多的表进行连接也都清晰可见。如果采用 SQL92，可读性就会大打折扣。</p></div> <div class="warning custom-block"><h2 id="不同-dbms-中使用连接需要注意的地方"><a href="#不同-dbms-中使用连接需要注意的地方" aria-hidden="true" class="header-anchor">#</a> 不同 DBMS 中使用连接需要注意的地方</h2> <h3 id="_1-不是所有的-dbms-都支持全外连接"><a href="#_1-不是所有的-dbms-都支持全外连接" aria-hidden="true" class="header-anchor">#</a> 1. 不是所有的 DBMS 都支持全外连接</h3> <p>Oracle、DB2、SQL Server 支持全外连接，但 MySQL、Access、SQLite、MariaDB 等数据库软件不支持全外连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 想在 MySQL 中写全外连接可以用 左外连接 UNION 右外连接，比如：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> team <span class="token keyword">ON</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> player <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> team <span class="token keyword">ON</span> player<span class="token punctuation">.</span>team_id <span class="token operator">=</span> team<span class="token punctuation">.</span>team_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-oracle-没有表别名-as"><a href="#_2-oracle-没有表别名-as" aria-hidden="true" class="header-anchor">#</a> 2. Oracle 没有表别名 AS</h3> <p>为了让 SQL 查询语句更简洁，经常会使用表别名 <code>AS</code>，不过在 Oracle 中是不存在 <code>AS</code> 的，使用表别名的时候，直接在表名后面写上表别名即可，比如 <code>player p</code>，而不是 <code>player AS p</code>。</p> <h3 id="_3-sqlite-的外连接只有左连接"><a href="#_3-sqlite-的外连接只有左连接" aria-hidden="true" class="header-anchor">#</a> 3. SQLite 的外连接只有左连接</h3> <p>SQLite 是一款轻量级的数据库软件，在外连接上只支持左连接，不支持右连接，如果想使用右连接的方式，比如 table1 RIGHT JOIN table2，在 SQLite 中可以写成 table2 LEFT JOIN table1，这样就可以得到相同的效果。</p> <h3 id="_4-控制连接表的数量"><a href="#_4-控制连接表的数量" aria-hidden="true" class="header-anchor">#</a> 4. 控制连接表的数量</h3> <p>多表连接就相当于嵌套 for 循环一样，非常消耗资源，会让 SQL 查询性能下降得很严重，因此不要连接不必要的表。在许多 DBMS 中，也都会有最大连接表的限制。</p> <h3 id="_5-在连接时不要忘记-where-语句"><a href="#_5-在连接时不要忘记-where-语句" aria-hidden="true" class="header-anchor">#</a> 5. 在连接时不要忘记 WHERE 语句</h3> <p>多表连接的目的不是为了做笛卡尔积，而是筛选符合条件的数据行，因此在多表连接的时候使用 WHERE 语句可以过滤掉不必要的数据行返回。</p> <h3 id="_6-使用自连接而不是子查询"><a href="#_6-使用自连接而不是子查询" aria-hidden="true" class="header-anchor">#</a> 6. 使用自连接而不是子查询</h3> <p>一般情况建议使用自连接，因为在许多 DBMS 的处理过程中，对于自连接的处理速度要比子查询快得多。</p> <p>可以这样理解：子查询实际上是通过未知表进行查询后的条件判断，而自连接是通过已知的自身数据表进行条件判断，因此在大部分 DBMS 中都对自连接处理进行了优化。</p></div> <h2 id="join"><a href="#join" aria-hidden="true" class="header-anchor">#</a> Join</h2> <p>JOIN 类型分为：内连接（INNER）、全外连接（FULL OUTER）、左外连接（LEFT OUTER）、右外连接（RIGHT OUTER）、交叉连接（CROSS）</p> <p><img src="/mysql/inner_join.jpg" alt="INNER JOIN"></p> <p><img src="/mysql/left_outer_join.jpg" alt="LEFT OUTER JOIN"></p> <p><img src="/mysql/right_outer_join.jpg" alt="RIGHT OUTER JOIN"></p> <p><img src="/mysql/full_outer_join.jpg" alt="FULL OUTER JOIN"></p> <p><img src="/mysql/full_outer_join_union_all.jpg" alt="UNION ALL"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/mysql/subquery.html" class="prev">子查询</a></span> <span class="next"><a href="/blog/mysql/sql.html">SQL 必知必会</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e2cc563c.js" defer></script><script src="/blog/assets/js/2.7449a846.js" defer></script><script src="/blog/assets/js/34.55bb6b06.js" defer></script>
  </body>
</html>
